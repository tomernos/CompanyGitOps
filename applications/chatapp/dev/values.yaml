# =========================================
# ChatApplication - Development Environment Values
# =========================================
# This file overrides values.yaml for dev environment

backend:
  enabled: true
  replicaCount: 1
  
  # ECR Image - CI pipeline updates these tags
  image:
    repository: 654654526828.dkr.ecr.eu-central-1.amazonaws.com/chatapp
    tag: backend-dev-6cc2f22  # Updated by CI: 2026-01-17T18:32:36Z
    pullPolicy: Always
  
  monitoring:
    enabled: true  # Enable Prometheus scraping
    scrapeInterval: 15s
    scrapeTimeout: 10s
  
  env:
    # OpenTelemetry - override namespace for dev environment
    OTEL_SERVICE_NAMESPACE: "chatapp-dev"

frontend:
  enabled: true
  replicaCount: 1
  
  # ECR Image - CI pipeline updates these tags
  image:
    repository: 654654526828.dkr.ecr.eu-central-1.amazonaws.com/chatapp
    tag: frontend-dev-6cc2f22  # Updated by CI: 2026-01-17T18:32:36Z
    pullPolicy: Always
  
  env:
    # Frontend needs correct backend URL to connect
    API_URL: http://chatapp-backend:5000
    BACKEND_URL: http://chatapp-backend:5000  # For nginx.conf proxy_pass substitution

# Disable database services (use external/shared instances in dev)
postgres:
  enabled: false

redis:
  enabled: false

rabbitmq:
  enabled: false

ingress:
  enabled: true  # Ensure ingress is enabled for dev
  # Hosts array - supports multiple hosts
  hosts:
    - host: chatapp-dev.tomernos.xyz
      paths:
        - path: /api
          pathType: Prefix
          serviceName: chatapp-backend
          servicePort: 5000
        - path: /
          pathType: Prefix
          serviceName: chatapp-frontend
          servicePort: 80
  
  # TLS - hosts will be automatically collected from ingress.hosts if not specified
  tls:
    - secretName: chatapp-tls

